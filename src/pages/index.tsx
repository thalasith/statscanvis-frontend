import { type NextPage } from "next";
import Head from "next/head";
import {
  AreaChart,
  Area,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
  ResponsiveContainer,
} from "recharts";
import { formatDate, shortenNumber } from "../utils/formatter";
import { api } from "../utils/api";

const Home: NextPage = () => {
  const { data } = api.labor_stats.getEmploymentByGeography.useQuery({
    geography: "Canada ",
    typeOfEmployee: "Salaried employees paid a fixed salary",
  });

  const chartData = [
    {
      dataKey: "forestry_logging_and_support",
      fill: "#3AB795",
      name: "Forestry",
    },
    {
      dataKey: "mining_quarrying_and_oil_and_gas_extraction",
      fill: "#A0E8AF",
      name: "Mining",
    },
    { dataKey: "utilities", fill: "#86BAA1", name: "Utilities" },
    { dataKey: "construction", fill: "#EDEAD0", name: "Construction" },
    { dataKey: "manufacturing", fill: "#FFCF56", name: "Manufacturing" },
  ];

  const Chart = () => {
    return (
      <div className="m-2 flex w-full flex-col items-center rounded border border-gray-400 lg:w-1/2">
        <h1 className="text-2xl font-bold text-gray-700">
          Employment by Industry
        </h1>

        <ResponsiveContainer width="95%" height={300}>
          <AreaChart data={data}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis
              dataKey="month"
              interval={1}
              tickFormatter={(value: string): string => {
                return formatDate(value);
              }}
            />
            <YAxis
              tickFormatter={(value): string => shortenNumber(value as number)}
            />
            <Tooltip
              formatter={(value): string => shortenNumber(value as number)}
              wrapperStyle={{ outline: "none" }}
            />
            <Legend />
            {chartData.map((item) => {
              return (
                <Area
                  key={item.name}
                  type="monotone"
                  name={item.name}
                  dataKey={item.dataKey}
                  stroke={item.fill}
                  fill={item.fill}
                  stackId="1"
                />
              );
            })}
          </AreaChart>
        </ResponsiveContainer>
      </div>
    );
  };

  return (
    <>
      <Head>
        <title>Create T3 App</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="flex min-h-screen flex-col items-center">
        <div className="container mx-auto">
          <div className="mx-2 w-1/3 bg-gray-200 px-4 py-5 sm:p-6">
            <div className="grid-rows row-span-3 grid">
              <div className="mb-4">
                <label
                  htmlFor="first-name"
                  className="block text-sm font-medium text-gray-700"
                >
                  Employee Type
                </label>
                <select
                  id="country"
                  name="country"
                  autoComplete="country-name"
                  className="mt-1 block w-full rounded-md border border-gray-300 bg-white py-2 px-3 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"
                >
                  <option>All employees</option>
                  <option>Employees paid by the hour</option>
                  <option>Salaried employees paid a fixed salary</option>
                </select>
              </div>

              <div className="mb-4">
                <label
                  htmlFor="first-name"
                  className="block text-sm font-medium text-gray-700"
                >
                  Employee Type
                </label>
                <select
                  id="country"
                  name="country"
                  autoComplete="country-name"
                  className="mt-1 block w-full rounded-md border border-gray-300 bg-white py-2 px-3 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"
                >
                  <option> Canada </option>
                  <option> Newfoundland and Labrador </option>
                  <option> Prince Edward Island </option>
                  <option> Nova Scotia </option>
                  <option> New Brunswick </option>
                  <option> Quebec </option>
                  <option> Ontario </option>
                  <option> Manitoba </option>
                  <option> Saskatchewan </option>
                  <option> Alberta </option>
                  <option> British Columbia </option>
                  <option> Yukon </option>
                  <option> Northwest Territories </option>
                  <option> Nunavut </option>
                </select>
              </div>
            </div>
          </div>
          <div className="flex w-full flex-col lg:flex-row">
            {data && <Chart />}
            {data && <Chart />}
          </div>
        </div>
        {/* </div> */}
      </main>
    </>
  );
};

export default Home;
